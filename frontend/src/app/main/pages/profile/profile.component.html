<div class="profile-container">
    <!-- Header -->
    <div class="profile-header">
        <div class="profile-header-content">
            <div class="profile-avatar">
                <mat-icon>account_circle</mat-icon>
            </div>
            <div class="profile-header-info">
                <h1>{{ user?.name || 'User' }}</h1>
                <p>{{ user?.email }}</p>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="profile-tabs">
        <button 
            class="tab-btn" 
            [class.active]="activeTab === 'info'"
            (click)="setActiveTab('info')">
            <mat-icon>person</mat-icon>
            <span>Profile Info</span>
        </button>
        <button 
            class="tab-btn" 
            [class.active]="activeTab === 'settings'"
            (click)="setActiveTab('settings')">
            <mat-icon>settings</mat-icon>
            <span>Settings</span>
        </button>
        <button 
            class="tab-btn" 
            [class.active]="activeTab === 'orders'"
            (click)="setActiveTab('orders')">
            <mat-icon>shopping_bag</mat-icon>
            <span>Purchase History</span>
        </button>
        <button 
            class="tab-btn" 
            [class.active]="activeTab === 'wishlist'"
            (click)="setActiveTab('wishlist')">
            <mat-icon>favorite</mat-icon>
            <span>Wishlist</span>
        </button>
    </div>

    <!-- Content Area -->
    <div class="profile-content">
        <!-- Profile Info Tab -->
        @if (activeTab === 'info') {
        <div class="tab-content">
            <h2>Profile Information</h2>
            <div class="info-grid">
                <div class="info-item">
                    <label>Full Name</label>
                    <p>{{ user?.name || 'N/A' }}</p>
                </div>
                <div class="info-item">
                    <label>Email Address</label>
                    <p>{{ user?.email || 'N/A' }}</p>
                </div>
                <div class="info-item">
                    <label>Member Since</label>
                    <p>{{ user?.createdAt ? formatDate(user.createdAt) : 'N/A' }}</p>
                </div>
                <div class="info-item">
                    <label>Account Status</label>
                    <p class="status-active">Active</p>
                </div>
            </div>
        </div>
        }

        <!-- Settings Tab -->
        @if (activeTab === 'settings') {
        <div class="tab-content">
            <h2>Settings</h2>
            <div class="settings-section">
                <h3>Preferences</h3>
                <div class="setting-item">
                    <div class="setting-label">
                        <label>Language</label>
                        <p>Choose your preferred language</p>
                    </div>
                    <select [(ngModel)]="language" class="setting-select">
                        <option value="en">English</option>
                        <option value="fr">Français</option>
                        <option value="es">Español</option>
                        <option value="de">Deutsch</option>
                    </select>
                </div>
            </div>

            <div class="settings-section">
                <h3>Notifications</h3>
                <div class="setting-item">
                    <div class="setting-label">
                        <label>Enable All Notifications</label>
                        <p>Receive updates about your orders and promotions</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" [(ngModel)]="notificationsEnabled">
                        <span class="slider"></span>
                    </label>
                </div>

                @if (notificationsEnabled) {
                <div class="setting-item">
                    <div class="setting-label">
                        <label>Email Notifications</label>
                        <p>Receive notifications via email</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" [(ngModel)]="emailNotifications">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div class="setting-label">
                        <label>Push Notifications</label>
                        <p>Receive push notifications on your device</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" [(ngModel)]="pushNotifications">
                        <span class="slider"></span>
                    </label>
                </div>
                }
            </div>

            <div class="settings-actions">
                <button class="btn btn-primary" (click)="saveSettings()">
                    <mat-icon>save</mat-icon>
                    Save Settings
                </button>
            </div>
        </div>
        }

        <!-- Orders Tab -->
        @if (activeTab === 'orders') {
        <div class="tab-content">
            <h2>Purchase History</h2>
            @if (loading) {
            <div class="loading">
                <p>Loading your orders...</p>
            </div>
            } @else if (orders.length > 0) {
            <div class="orders-list">
                @for (order of orders; track order.orderId) {
                <div class="order-card">
                    <div class="order-header">
                        <div class="order-info">
                            <h3>Order #{{ order.orderId }}</h3>
                            <p class="order-date">{{ formatDate(order.createdAt) }}</p>
                        </div>
                        <div class="order-status">
                            <span [class]="'badge ' + getStatusBadgeClass(order.status)">
                                {{ getStatusLabel(order.status) }}
                            </span>
                        </div>
                    </div>
                    <div class="order-items">
                        @for (item of order.items; track item.orderItemId) {
                        <div class="order-item">
                            <span class="item-name">{{ item.product?.name }}</span>
                            <span class="item-qty">x{{ item.quantity }}</span>
                            <span class="item-price">{{ formatPrice((item.product?.price || 0) * item.quantity) }}</span>
                        </div>
                        }
                    </div>
                    <div class="order-footer">
                        <div class="order-total">
                            <strong>Total:</strong>
                            <span class="total-amount">{{ formatPrice(getOrderTotal(order)) }}</span>
                        </div>
                    </div>
                </div>
                }
            </div>
            } @else {
            <div class="empty-state">
                <mat-icon>shopping_bag</mat-icon>
                <p>No orders yet</p>
                <p class="empty-text">Start shopping to see your purchase history here</p>
            </div>
            }
        </div>
        }

        <!-- Wishlist Tab -->
        @if (activeTab === 'wishlist') {
        <div class="tab-content">
            <h2>Wishlist</h2>
            @if (wishlist.length > 0) {
            <div class="wishlist-grid">
                @for (item of wishlist; track item.productId) {
                <div class="wishlist-item">
                    <div class="wishlist-image">
                        @if (item.imageUrl) {
                        <img [src]="item.imageUrl" [alt]="item.productName">
                        } @else {
                        <div class="no-image">No image</div>
                        }
                    </div>
                    <div class="wishlist-info">
                        <h4>{{ item.productName }}</h4>
                        <p class="wishlist-price">{{ formatPrice(item.price) }}</p>
                        <button class="btn-remove" (click)="removeFromWishlist(item.productId)">
                            <mat-icon>close</mat-icon>
                            Remove
                        </button>
                    </div>
                </div>
                }
            </div>
            } @else {
            <div class="empty-state">
                <mat-icon>favorite_border</mat-icon>
                <p>Your wishlist is empty</p>
                <p class="empty-text">Add items to your wishlist to save them for later</p>
            </div>
            }
        </div>
        }
    </div>

    <!-- Logout Button -->
    <div class="profile-footer">
        <button class="btn btn-logout" (click)="logout()">
            <mat-icon>logout</mat-icon>
            Logout
        </button>
    </div>
</div>
